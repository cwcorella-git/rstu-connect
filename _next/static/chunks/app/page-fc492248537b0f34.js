(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3592:function(e){function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=3592,e.exports=t},8010:function(e,t,s){Promise.resolve().then(s.bind(s,7658))},7658:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),r=s(2265);function l(e){var t;let{building:s,isSelected:r,onClick:l}=e,n=(null===(t=s.address.split(",")[0])||void 0===t?void 0:t.trim())||s.address;return(0,a.jsx)("li",{className:"p-4 cursor-pointer hover:bg-gray-50 transition border-l-4 ".concat(r?"bg-red-50 border-l-rstu-red":"border-l-transparent"),onClick:l,children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm text-gray-900",children:n}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:s.address}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[s.units," units • ",s.owner]})]}),(0,a.jsx)("span",{className:"bg-blue-100 text-blue-900 px-2 py-1 rounded text-xs font-medium whitespace-nowrap ml-2",children:"Organizing"})]})})}function n(e){let{buildings:t,selectedBuilding:s,onSelectBuilding:n}=e,[i,o]=(0,r.useState)(""),d=(0,r.useMemo)(()=>{if(!i.trim())return t;let e=i.toLowerCase();return t.filter(t=>t.address.toLowerCase().includes(e)||t.owner.toLowerCase().includes(e))},[t,i]);return(0,a.jsxs)("div",{className:"w-2/5 border-r border-gray-200 flex flex-col bg-white",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search buildings...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-rstu-red",value:i,onChange:e=>o(e.target.value)}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[d.length," building",1!==d.length?"s":""]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,a.jsx)("ul",{className:"divide-y divide-gray-200",children:d.map(e=>(0,a.jsx)(l,{building:e,isSelected:s.apn===e.apn,onClick:()=>n(e)},e.apn))}),0===d.length&&(0,a.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No buildings match your search."})]})]})}var i=s(4364),o=s.n(i);let d={peers:["https://rstu-gun-relay.onrender.com/gun"],localStorage:!0,radisk:!0},c=null;function u(e){let t=function(){if(!c){c=o()(d),console.log("[Gun.js] Initializing with peers:",d.peers);let e=c.back("opt.peers");e&&Object.keys(e).forEach(t=>{let s=e[t];console.log("[Gun.js] Peer ".concat(t,":"),s?"connected":"failed")})}return c}();return t?t.get("rstu").get("chat").get(e):null}function x(e){let{messages:t,isConnected:s}=e,l=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;null===(e=l.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[t]);let n=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,a.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto bg-gray-50 p-4 space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs ".concat(s?"text-green-600":"text-gray-400"),children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s?"bg-green-500":"bg-gray-400")}),s?"Connected to P2P network":"Connecting..."]})}),0===t.length?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400 text-sm text-center px-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"No messages yet"}),(0,a.jsx)("p",{className:"text-xs",children:"Start the conversation! Your messages sync peer-to-peer."})]})}):t.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-3 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-baseline justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 text-sm",children:e.username}),(0,a.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:n(e.timestamp)})]}),(0,a.jsx)("p",{className:"text-gray-700 text-sm whitespace-pre-wrap break-words",children:e.text})]},e.id)),(0,a.jsx)("div",{ref:l})]})}function m(e){let{onSendMessage:t,isConnected:s}=e,[l,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{{let e=localStorage.getItem("rstu_chat_username");e&&(o(e),x(!0))}},[]);let m=()=>{if(!d.trim()){alert("Please enter a name");return}let e=d.trim();o(e),x(!0),localStorage.setItem("rstu_chat_username",e)};return(0,a.jsx)("div",{className:"border-t border-gray-200 bg-white p-4",children:(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),l.trim()){if(!u){alert("Please confirm your name first");return}t(l,i),n("")}},className:"space-y-3",children:[!u&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-xs font-medium text-gray-700 mb-1",children:"Your Name (saved locally)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{id:"username",type:"text",value:d,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),m())},placeholder:"Enter your name...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rstu-red focus:border-transparent text-sm",maxLength:30,autoFocus:!0}),(0,a.jsx)("button",{type:"button",onClick:m,className:"px-4 py-2 bg-rstu-red text-white rounded-lg hover:bg-red-700 font-medium text-sm transition-colors",children:"Set Name"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Press Enter or click "Set Name" to confirm'})]}),u&&(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:["Posting as: ",(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:i})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{x(!1),c(i)},className:"text-rstu-red hover:underline",children:"Change name"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:e=>n(e.target.value),placeholder:s?"Type a message...":"Connecting...",disabled:!s||!u,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rstu-red focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-sm",maxLength:500}),(0,a.jsx)("button",{type:"submit",disabled:!s||!l.trim()||!u,className:"px-4 py-2 bg-rstu-red text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm transition-colors",children:"Send"})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400 text-right",children:[l.length,"/500"]})]})})}async function g(){try{let e=[];for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t);s&&(s.startsWith("gun/")||s.startsWith("radata"))&&e.push(s)}for(let t of(e.forEach(e=>localStorage.removeItem(e)),localStorage.removeItem("rstu_chat_username"),await window.indexedDB.databases()))t.name&&(t.name.includes("gun")||t.name.includes("radata"))&&window.indexedDB.deleteDatabase(t.name);console.log("[Gun Admin] Cleared local Gun.js data")}catch(e){console.error("[Gun Admin] Error clearing local data:",e)}}function h(e){let{chatSlug:t,onDataCleared:s}=e,[l,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!1),d=async()=>{confirm("Clear all local chat data from your browser? This will reset your username and local message cache. You can still see messages from the server.")&&(o(!0),await g(),o(!1),alert("Local data cleared! Refreshing page..."),s&&s(),window.location.reload())};return(0,a.jsxs)("div",{className:"border-t border-gray-200 bg-gray-50",children:[(0,a.jsxs)("button",{onClick:()=>n(!l),className:"w-full px-4 py-2 text-left text-xs font-medium text-gray-600 hover:bg-gray-100 transition-colors flex items-center justify-between",children:[(0,a.jsx)("span",{children:"⚙️ Admin Tools"}),(0,a.jsx)("span",{className:"text-gray-400",children:l?"▼":"▶"})]}),l&&(0,a.jsxs)("div",{className:"px-4 py-3 space-y-3 bg-white border-t border-gray-200",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Use these tools if chat is not working properly or to clear data."}),(0,a.jsx)("button",{onClick:d,disabled:i,className:"w-full px-3 py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:i?"Clearing...":"\uD83D\uDD04 Clear My Local Data"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Clears your browser's Gun.js cache and resets your username. Use this if chat stops syncing."}),(0,a.jsx)("button",{onClick:()=>{confirm("Delete ALL messages from this chat room? This affects everyone and cannot be undone!")&&confirm("Are you ABSOLUTELY sure? This will delete all messages for all users in this building.")&&(!function(e){let t=u(e);if(!t){console.error("[Gun Admin] Cannot clear chat: Gun not initialized");return}let s=t.get("messages");s.map().once((e,t)=>{e&&s.get(t).put(null)}),console.log("[Gun Admin] Cleared all messages for chat: ".concat(e))}(t),alert("All messages deleted from chat room. You may need to refresh to see changes."),s&&s())},className:"w-full px-3 py-2 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition-colors",children:"\uD83D\uDDD1️ Delete All Messages"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,a.jsx)("strong",{children:"Warning:"})," Deletes all messages for everyone in this chat room. Cannot be undone!"]})]})]})}function f(e){let{chatSlug:t,buildingAddress:s}=e,{messages:l,sendMessage:n,isConnected:i}=function(e){let[t,s]=(0,r.useState)([]),[a,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=u(e);if(!t){console.error("Failed to initialize Gun chat node");return}let a=t.get("messages");return l(!0),a.map().on((e,t)=>{if(!e)return;let a={id:t,text:e.text||"",username:e.username||"Anonymous",timestamp:e.timestamp||Date.now()};s(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?a:e):[...e,a].sort((e,t)=>e.timestamp-t.timestamp))}),()=>{l(!1),s([])}},[e]),{messages:t,sendMessage:(0,r.useCallback)((t,s)=>{if(!t.trim())return;let a=u(e);if(!a){console.error("Cannot send message: Gun not initialized");return}let r={text:t.trim(),username:s||"Anonymous",timestamp:Date.now()};a.get("messages").set(r)},[e]),isConnected:a,clearMessages:(0,r.useCallback)(()=>{s([])},[])}}(t);return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-white",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:s}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Decentralized P2P organizing chat • No login required • Messages sync across all peers"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(x,{messages:l,isConnected:i})}),(0,a.jsx)(m,{onSendMessage:n,isConnected:i}),(0,a.jsx)(h,{chatSlug:t})]})}function y(e){let{building:t}=e,[s,l]=(0,r.useState)(!0);return s?(0,a.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white/95 p-4 rounded shadow-lg max-w-xs",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-gray-900",children:"Building Details"}),(0,a.jsx)("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600 text-xs",children:"✕"})]}),(0,a.jsxs)("dl",{className:"space-y-1 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"Owner:"}),(0,a.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.owner})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"Units:"}),(0,a.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.units.toLocaleString()})]}),t.yearBuilt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"Built:"}),(0,a.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.yearBuilt})]}),t.sqft&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"Size:"}),(0,a.jsxs)("dd",{className:"text-gray-900 inline ml-1",children:[t.sqft.toLocaleString()," sq ft"]})]}),t.value&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"Assessed Value:"}),(0,a.jsxs)("dd",{className:"text-gray-900 inline ml-1",children:["$",t.value.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-gray-500 inline",children:"APN:"}),(0,a.jsx)("dd",{className:"text-gray-900 inline ml-1 font-mono text-[10px]",children:t.apn})]})]})]}):(0,a.jsx)("button",{onClick:()=>l(!0),className:"absolute bottom-4 left-4 bg-white/90 px-3 py-2 rounded shadow-lg text-xs text-gray-600 hover:bg-white transition",children:"Show building info"})}function p(){let e=[{apn:"1221136",address:"2500 E 2ND ST, RENO, NV 89502",owner:"GAGE VILLAGE COMMERCIAL DEV LLC et al",units:1495,value:36827351,yearBuilt:null,sqft:null,chatSlug:"rstu-2500-e-2nd-st"},{apn:"1925018",address:"2707 S VIRGINIA ST, RENO, NV 89502",owner:"PEPPERMILL CASINOS INC",units:1453,value:113983994,yearBuilt:null,sqft:null,chatSlug:"rstu-2707-s-virginia-st"},{apn:"726128",address:"500 WEST ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:906,value:10209015,yearBuilt:null,sqft:null,chatSlug:"rstu-500-west-st"},{apn:"726129",address:"130 W 6TH ST, RENO, NV 89501",owner:"UCCELLI LIVING TRUST et al",units:905,value:1592806,yearBuilt:null,sqft:null,chatSlug:"rstu-130-w-6th-st"},{apn:"726112",address:"190 W 6TH ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:905,value:789043,yearBuilt:null,sqft:null,chatSlug:"rstu-190-w-6th-st"},{apn:"2025458",address:"3800 S VIRGINIA ST, RENO, NV 89502",owner:"GOLDEN ROAD MOTOR INN INC",units:825,value:61763887,yearBuilt:null,sqft:null,chatSlug:"rstu-3800-s-virginia-st"},{apn:"3217228",address:"1100 NUGGET AVE, SPARKS, NV 89431",owner:"SMOOTH BOURBON LLC",units:800,value:17130330,yearBuilt:null,sqft:null,chatSlug:"rstu-1100-nugget-ave"},{apn:"754215",address:"345 N ARLINGTON AVE, RENO, NV 89501",owner:"JESR LLC",units:779,value:10862110,yearBuilt:null,sqft:null,chatSlug:"rstu-345-n-arlington-ave"},{apn:"726226",address:"500 N SIERRA ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:673,value:15560272,yearBuilt:null,sqft:null,chatSlug:"rstu-500-n-sierra-st"},{apn:"729229",address:"325 N SIERRA ST, RENO, NV 89501",owner:"ELDORADO RESORTS LLC",units:656,value:3217496,yearBuilt:null,sqft:null,chatSlug:"rstu-325-n-sierra-st"}],[t,s]=(0,r.useState)(e[0]);return(0,a.jsxs)("div",{className:"flex h-screen",style:{height:"calc(100vh - 140px)"},children:[(0,a.jsx)(n,{buildings:e,selectedBuilding:t,onSelectBuilding:s}),(0,a.jsxs)("div",{className:"w-3/5 flex flex-col bg-white relative",children:[(0,a.jsx)(f,{chatSlug:t.chatSlug,buildingAddress:t.address}),(0,a.jsx)(y,{building:t})]})]})}}},function(e){e.O(0,[364,971,23,744],function(){return e(e.s=8010)}),_N_E=e.O()}]);
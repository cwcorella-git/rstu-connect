(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3592:function(e){function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=3592,e.exports=t},8010:function(e,t,s){Promise.resolve().then(s.bind(s,7213))},7213:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var n=s(7437),a=s(2265);function r(e){var t;let{building:s,isSelected:a,onClick:r}=e,l=(null===(t=s.address.split(",")[0])||void 0===t?void 0:t.trim())||s.address;return(0,n.jsx)("li",{className:"p-4 cursor-pointer hover:bg-gray-50 transition border-l-4 ".concat(a?"bg-red-50 border-l-rstu-red":"border-l-transparent"),onClick:r,children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-sm text-gray-900",children:l}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:s.address}),(0,n.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[s.units," units • ",s.owner]})]}),(0,n.jsx)("span",{className:"bg-blue-100 text-blue-900 px-2 py-1 rounded text-xs font-medium whitespace-nowrap ml-2",children:"Organizing"})]})})}function l(e){let{buildings:t,selectedBuilding:s,onSelectBuilding:l}=e,[i,d]=(0,a.useState)(""),c=(0,a.useMemo)(()=>{if(!i.trim())return t;let e=i.toLowerCase();return t.filter(t=>t.address.toLowerCase().includes(e)||t.owner.toLowerCase().includes(e))},[t,i]);return(0,n.jsxs)("div",{className:"w-2/5 border-r border-gray-200 flex flex-col bg-white",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search buildings...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-rstu-red",value:i,onChange:e=>d(e.target.value)}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[c.length," building",1!==c.length?"s":""]})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,n.jsx)("ul",{className:"divide-y divide-gray-200",children:c.map(e=>(0,n.jsx)(r,{building:e,isSelected:s.apn===e.apn,onClick:()=>l(e)},e.apn))}),0===c.length&&(0,n.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No buildings match your search."})]})]})}var i=s(4364),d=s.n(i);let c={peers:["https://rstu-gun-relay.onrender.com/gun"],localStorage:!0,radisk:!0},u=null;function o(e){let t=function(){if(!u){u=d()(c),console.log("[Gun.js] Initializing with peers:",c.peers);let e=u.back("opt.peers");e&&Object.keys(e).forEach(t=>{let s=e[t];console.log("[Gun.js] Peer ".concat(t,":"),s?"connected":"failed")})}return u}();return t?t.get("rstu").get("chat").get(e):null}function m(e){let{messages:t,typingUsers:s,isConnected:r}=e,l=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;null===(e=l.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[t]);let i=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,n.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto bg-gray-50 p-4 space-y-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs ".concat(r?"text-green-600":"text-gray-400"),children:[(0,n.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(r?"bg-green-500":"bg-gray-400")}),r?"Connected to P2P network":"Connecting..."]})}),0===t.length?(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400 text-sm text-center px-8",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium mb-1",children:"No messages yet"}),(0,n.jsx)("p",{className:"text-xs",children:"Start the conversation! Your messages sync peer-to-peer."})]})}):t.map(e=>(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-3 hover:shadow-md transition-shadow",children:[(0,n.jsxs)("div",{className:"flex items-baseline justify-between mb-1",children:[(0,n.jsx)("span",{className:"font-semibold text-gray-900 text-sm",children:e.username}),(0,n.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:i(e.timestamp)})]}),(0,n.jsx)("p",{className:"text-gray-700 text-sm whitespace-pre-wrap break-words",children:e.text})]},e.id)),s.length>0&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 italic px-3 py-2",children:[(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0ms"},children:"●"}),(0,n.jsx)("span",{className:"animate-bounce",style:{animationDelay:"150ms"},children:"●"}),(0,n.jsx)("span",{className:"animate-bounce",style:{animationDelay:"300ms"},children:"●"})]}),(0,n.jsx)("span",{children:1===s.length?"".concat(s[0].username," is typing..."):2===s.length?"".concat(s[0].username," and ").concat(s[1].username," are typing..."):"".concat(s.length," people are typing...")})]}),(0,n.jsx)("div",{ref:l})]})}function x(e){let{onSendMessage:t,onSetTyping:s,isConnected:r}=e,[l,i]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,o]=(0,a.useState)(""),[m,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{{let e=localStorage.getItem("rstu_chat_username");e&&(c(e),x(!0))}},[]);let g=()=>{if(!u.trim()){alert("Please enter a name");return}let e=u.trim();c(e),x(!0),localStorage.setItem("rstu_chat_username",e)};return(0,n.jsx)("div",{className:"border-t border-gray-200 bg-white p-4",children:(0,n.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),l.trim()){if(!m){alert("Please confirm your name first");return}t(l,d),i("")}},className:"space-y-3",children:[!m&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"username",className:"block text-xs font-medium text-gray-700 mb-1",children:"Your Name (saved locally)"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{id:"username",type:"text",value:u,onChange:e=>o(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),g())},placeholder:"Enter your name...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rstu-red focus:border-transparent text-sm",maxLength:30,autoFocus:!0}),(0,n.jsx)("button",{type:"button",onClick:g,className:"px-4 py-2 bg-rstu-red text-white rounded-lg hover:bg-red-700 font-medium text-sm transition-colors",children:"Set Name"})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Press Enter or click "Set Name" to confirm'})]}),m&&(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,n.jsxs)("span",{children:["Posting as: ",(0,n.jsx)("span",{className:"font-semibold text-gray-900",children:d})]}),(0,n.jsx)("button",{type:"button",onClick:()=>{x(!1),o(d)},className:"text-rstu-red hover:underline",children:"Change name"})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{type:"text",value:l,onChange:e=>{i(e.target.value),m&&e.target.value.trim()&&s(d)},placeholder:r?"Type a message...":"Connecting...",disabled:!r||!m,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rstu-red focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-sm",maxLength:500}),(0,n.jsx)("button",{type:"submit",disabled:!r||!l.trim()||!m,className:"px-4 py-2 bg-rstu-red text-white rounded-lg hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium text-sm transition-colors",children:"Send"})]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400 text-right",children:[l.length,"/500"]})]})})}function g(e){let{chatSlug:t,buildingAddress:s}=e,{messages:r,sendMessage:l,setTyping:i,typingUsers:d,isConnected:c}=function(e){let[t,s]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[l,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=o(e);if(!t){console.error("Failed to initialize Gun chat node");return}let n=t.get("messages");i(!0);let a=n.map().on((e,t)=>{if(!e)return;let n={id:t,text:e.text||"",username:e.username||"Anonymous",timestamp:e.timestamp||Date.now()};s(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?n:e):[...e,n].sort((e,t)=>e.timestamp-t.timestamp))});return()=>{a&&a.off&&a.off(),i(!1),s([])}},[e]),(0,a.useEffect)(()=>{let t=o(e);if(!t)return;let s=t.get("typing").map().on((e,t)=>{if(!e||!e.timestamp){r(e=>e.filter(e=>e.username!==t));return}if(Date.now()-e.timestamp>3e3){r(e=>e.filter(e=>e.username!==t));return}r(s=>[...s.filter(e=>e.username!==t),{username:t,timestamp:e.timestamp}])}),n=setInterval(()=>{let e=Date.now();r(t=>t.filter(t=>e-t.timestamp<3e3))},1e3);return()=>{s&&s.off&&s.off(),clearInterval(n),r([])}},[e]),{messages:t,sendMessage:(0,a.useCallback)((t,s)=>{if(!t.trim())return;let n=o(e);if(!n){console.error("Cannot send message: Gun not initialized");return}let a={text:t.trim(),username:s||"Anonymous",timestamp:Date.now()};n.get("messages").set(a),n.get("typing").get(s).put(null)},[e]),setTyping:(0,a.useCallback)(t=>{if(!t)return;let s=o(e);s&&s.get("typing").get(t).put({timestamp:Date.now()})},[e]),typingUsers:n,isConnected:l,clearMessages:(0,a.useCallback)(()=>{s([])},[])}}(t);return(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-white",children:[(0,n.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:s}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Decentralized P2P organizing chat • Real-time updates • No login required"})]}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,n.jsx)(m,{messages:r,typingUsers:d,isConnected:c})}),(0,n.jsx)(x,{onSendMessage:l,onSetTyping:i,isConnected:c})]})}function h(e){let{building:t}=e,[s,r]=(0,a.useState)(!0);return s?(0,n.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white/95 p-4 rounded shadow-lg max-w-xs",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsx)("h3",{className:"font-bold text-sm text-gray-900",children:"Building Details"}),(0,n.jsx)("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600 text-xs",children:"✕"})]}),(0,n.jsxs)("dl",{className:"space-y-1 text-xs",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"Owner:"}),(0,n.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.owner})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"Units:"}),(0,n.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.units.toLocaleString()})]}),t.yearBuilt&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"Built:"}),(0,n.jsx)("dd",{className:"text-gray-900 inline ml-1",children:t.yearBuilt})]}),t.sqft&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"Size:"}),(0,n.jsxs)("dd",{className:"text-gray-900 inline ml-1",children:[t.sqft.toLocaleString()," sq ft"]})]}),t.value&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"Assessed Value:"}),(0,n.jsxs)("dd",{className:"text-gray-900 inline ml-1",children:["$",t.value.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"text-gray-500 inline",children:"APN:"}),(0,n.jsx)("dd",{className:"text-gray-900 inline ml-1 font-mono text-[10px]",children:t.apn})]})]})]}):(0,n.jsx)("button",{onClick:()=>r(!0),className:"absolute bottom-4 left-4 bg-white/90 px-3 py-2 rounded shadow-lg text-xs text-gray-600 hover:bg-white transition",children:"Show building info"})}function f(){let e=[{apn:"1221136",address:"2500 E 2ND ST, RENO, NV 89502",owner:"GAGE VILLAGE COMMERCIAL DEV LLC et al",units:1495,value:36827351,yearBuilt:null,sqft:null,chatSlug:"rstu-2500-e-2nd-st"},{apn:"1925018",address:"2707 S VIRGINIA ST, RENO, NV 89502",owner:"PEPPERMILL CASINOS INC",units:1453,value:113983994,yearBuilt:null,sqft:null,chatSlug:"rstu-2707-s-virginia-st"},{apn:"726128",address:"500 WEST ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:906,value:10209015,yearBuilt:null,sqft:null,chatSlug:"rstu-500-west-st"},{apn:"726129",address:"130 W 6TH ST, RENO, NV 89501",owner:"UCCELLI LIVING TRUST et al",units:905,value:1592806,yearBuilt:null,sqft:null,chatSlug:"rstu-130-w-6th-st"},{apn:"726112",address:"190 W 6TH ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:905,value:789043,yearBuilt:null,sqft:null,chatSlug:"rstu-190-w-6th-st"},{apn:"2025458",address:"3800 S VIRGINIA ST, RENO, NV 89502",owner:"GOLDEN ROAD MOTOR INN INC",units:825,value:61763887,yearBuilt:null,sqft:null,chatSlug:"rstu-3800-s-virginia-st"},{apn:"3217228",address:"1100 NUGGET AVE, SPARKS, NV 89431",owner:"SMOOTH BOURBON LLC",units:800,value:17130330,yearBuilt:null,sqft:null,chatSlug:"rstu-1100-nugget-ave"},{apn:"754215",address:"345 N ARLINGTON AVE, RENO, NV 89501",owner:"JESR LLC",units:779,value:10862110,yearBuilt:null,sqft:null,chatSlug:"rstu-345-n-arlington-ave"},{apn:"726226",address:"500 N SIERRA ST, RENO, NV 89501",owner:"CCR NEWCO LLC",units:673,value:15560272,yearBuilt:null,sqft:null,chatSlug:"rstu-500-n-sierra-st"},{apn:"729229",address:"325 N SIERRA ST, RENO, NV 89501",owner:"ELDORADO RESORTS LLC",units:656,value:3217496,yearBuilt:null,sqft:null,chatSlug:"rstu-325-n-sierra-st"}],[t,s]=(0,a.useState)(e[0]);return(0,n.jsxs)("div",{className:"flex h-screen",style:{height:"calc(100vh - 140px)"},children:[(0,n.jsx)(l,{buildings:e,selectedBuilding:t,onSelectBuilding:s}),(0,n.jsxs)("div",{className:"w-3/5 flex flex-col bg-white relative",children:[(0,n.jsx)(g,{chatSlug:t.chatSlug,buildingAddress:t.address}),(0,n.jsx)(h,{building:t})]})]})}}},function(e){e.O(0,[364,971,23,744],function(){return e(e.s=8010)}),_N_E=e.O()}]);